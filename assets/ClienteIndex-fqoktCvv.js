import{r as c,j as e,L as k}from"./index-FEUtmEKI.js";import{a as F}from"./index-xsH4HHeE.js";import{f as y,a as P}from"./utils-DFDuN5bX.js";const w=({onPesquisar:a})=>{const[l,t]=c.useState({nome:"",cpfCnpj:"",telefone:"",telefoneCelular:"",email:""}),i=m=>{const{name:r,value:o}=m.target;t(b=>({...b,[r]:o}))},h=()=>{a(l)},[u,d]=c.useState(""),s=m=>{const r=y(m.target.value);d(r),t(o=>({...o,cpfCnpj:r}))},[j,p]=c.useState(""),x=m=>{const r=P(m.target.value);p(r),t(o=>({...o,telefone:r})),t(o=>({...o,telefoneCelular:r}))};return e.jsx(e.Fragment,{children:e.jsx("section",{children:e.jsxs("div",{className:"mt-3 mb-5",children:[e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-3",children:[e.jsx("label",{htmlFor:"cpfCnpj",children:"CPF"}),e.jsx("div",{className:"input-group mb-3",children:e.jsx("input",{type:"text",className:"form-control",id:"cpfCnpj",name:"cpfCnpj","aria-label":"CPF","aria-describedby":"basic-addon1",maxLength:"18",value:u,onChange:s})})]}),e.jsxs("div",{className:"col-md-3",children:[e.jsx("label",{htmlFor:"nome",children:"Nome"}),e.jsx("div",{className:"input-group mb-3",children:e.jsx("input",{type:"text",className:"form-control",id:"nome",name:"nome",maxLength:"250","aria-describedby":"basic-addon2",value:l.nome,onChange:i})})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{htmlFor:"email",children:"E-mail"}),e.jsx("div",{className:"input-group mb-3",children:e.jsx("input",{type:"text",className:"form-control",id:"email",name:"email",maxLength:"250",value:l.email,onChange:i})})]})]}),e.jsx("div",{className:"row",children:e.jsxs("div",{className:"col-md-3",children:[e.jsx("label",{htmlFor:"telefoneCelular",children:"Telefone Celular"}),e.jsx("div",{className:"input-group mb-3",children:e.jsx("input",{type:"text",className:"form-control",id:"telefoneCelular",name:"telefoneCelular",maxLength:"15",value:j,onChange:x})})]})}),e.jsx("div",{children:e.jsxs("button",{className:"btn btn-outline-primary btn-md px-4 mb-3 float-end",onClick:h,children:[e.jsx("i",{className:"fa fa-search","aria-hidden":"true",children:" "}),e.jsx("span",{children:" Pesquisar "})]})})]})})})},S=({clientes:a,paginaAtual:l,totalPaginas:t,onPaginaChange:i,onExcluir:h})=>{const u=s=>{window.location.href=`/FormCliente/${s}`};if(!a||a.length===0)return null;const d=[];for(let s=1;s<=t;s++)d.push(s);return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"pt-3 mt-5",children:[e.jsx("h5",{className:"titulo text-light p-2 px-3 mb-3 text-start",style:{backgroundColor:"#00385e",borderRadius:"5px"},children:e.jsx("span",{className:"text-light",children:"Clientes cadastrados"})}),e.jsx("div",{className:"collapse show",id:"collapseCliente",children:e.jsx("div",{className:"card card-body",children:e.jsxs("div",{className:"table-responsive",children:[e.jsxs("table",{className:"table table-striped list",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-100",children:[e.jsx("th",{className:"py-2 px-4 border-b",width:"30%",children:"Nome"}),e.jsx("th",{className:"py-2 px-4 border-b",width:"15%",children:"CPF"}),e.jsx("th",{className:"py-2 px-4 border-b",width:"50%",children:"E-mail"}),e.jsx("th",{className:"py-2 px-4 border-b",width:"3%"}),e.jsx("th",{className:"py-2 px-4 border-b",width:"3%"})]})}),e.jsx("tbody",{children:a.length>0?a.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 px-4 border-b",children:s.nome}),e.jsx("td",{className:"py-2 px-4 border-b",children:y(s.cpfcnpj)}),e.jsx("td",{className:"py-2 px-4 border-b",children:s.email}),e.jsx("td",{children:e.jsx("a",{href:"#",onClick:()=>u(s.id),children:e.jsx("i",{className:"bi bi-pencil-square"})})}),e.jsx("td",{children:e.jsx("a",{href:"#",onClick:()=>h(s),children:e.jsx("i",{className:"bi bi-trash",style:{color:"#c70505"},"aria-hidden":"true"})})})]},s.id)):e.jsx("tr",{children:e.jsx("td",{className:"py-4 px-4 border-b text-center",colSpan:"4",children:"Nenhum cliente encontrado."})})})]}),e.jsx("nav",{"aria-label":"Paginação",children:e.jsxs("ul",{className:"pagination",children:[e.jsx("li",{className:`page-item ${l===1?"disabled":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>i(l-1),children:"Anterior"})}),d.map(s=>e.jsx("li",{className:`page-item ${l===s?"active":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>i(s),children:s})},s)),e.jsx("li",{className:`page-item ${l===t?"disabled":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>i(l+1),children:"Próximo"})})]})})]})})})]})})};function g({children:a,className:l="",type:t="button",...i}){return e.jsx("button",{type:t,className:`px-4 py-2 bg-primary text-white font-semibold rounded hover:bg-primary-dark transition ${l}`,...i,children:a})}function D({children:a}){return e.jsx("div",{className:"modal d-block",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsx("div",{className:"modal-content",children:a})})})}function $({children:a}){return e.jsx("div",{className:"modal-body",children:a})}function L({children:a}){return e.jsx("div",{className:"modal-header",children:a})}function A({children:a}){return e.jsx("div",{className:"modal-footer",children:a})}function I({children:a}){return e.jsx("div",{className:"modal-footer",children:a})}const T=({cliente:a,onConfirmar:l,onCancelar:t})=>e.jsx(D,{open:!0,onOpenChange:t,children:e.jsxs($,{children:[e.jsx(L,{children:e.jsx(I,{children:"Confirmar Exclusão"})}),e.jsx("div",{className:"py-4",children:e.jsxs("p",{children:["Deseja realmente excluir o cliente ",e.jsx("strong",{children:a.nome}),"?"]})}),e.jsxs(A,{className:"flex justify-end gap-2",children:[e.jsx(g,{variant:"outline",onClick:t,children:"Cancelar"}),e.jsx(g,{variant:"destructive",onClick:l,children:"Excluir"})]})]})}),q="http://localhost:3000",v=`${q}/customers`,_=()=>{const[a,l]=c.useState({clientes:[],paginaAtual:1,totalPaginas:1}),[t,i]=c.useState(""),[h,u]=c.useState({nome:"",cpfCnpj:"",telefone:"",telefoneCelular:"",email:""}),[d,s]=c.useState(null),[j,p]=c.useState(!1);c.useEffect(()=>{console.log("[useEffect] Chamando buscarClientes sem filtro"),x(h)},[]);const x=async(n,f=1,E=5)=>{try{const C=(await F.get(`${v}/getCustomers`,{params:{page:f,limit:E,nome:n.nome,cpfcnpj:n.cpfCnpj,email:n.email,telefoneCelular:n.telefoneCelular}})).data;l({clientes:C.clientes,paginaAtual:C.paginaAtual,totalPaginas:C.totalPaginas})}catch(N){console.error("Erro ao buscar clientes:",N)}},m=async n=>{console.log(JSON.stringify(n,null,2)),x(n,1)},r=async()=>{const n=localStorage.getItem("TokenCerimonial");try{await fetch(`${v}/deleteCustomer/${d.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${n}`}}),p(!1),x(t)}catch(f){console.error("Erro ao excluir cliente:",f)}},o=n=>{s(n),p(!0)},b=()=>{p(!1)};return e.jsxs("div",{className:"container mt-4",children:[e.jsx("div",{className:"pb-5 mb-1",children:e.jsxs(k,{to:"/FormCliente",className:"btn btn-primary px-4 mb-3 float-end",children:[e.jsx("i",{className:"fa fa-reply"})," ",e.jsx("span",{className:"hidden-xs",children:" Novo cliente "})]})}),e.jsx(w,{onPesquisar:m}),e.jsx(S,{clientes:a.clientes,paginaAtual:a.paginaAtual,totalPaginas:a.totalPaginas,onPaginaChange:n=>x(t,n),onExcluir:o}),j&&d&&e.jsx(T,{cliente:d,onConfirmar:r,onCancelar:b})]})};export{_ as default};
